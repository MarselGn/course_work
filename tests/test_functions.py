import pytest
from src.functions import get_data, get_filter_data, get_format_data, get_sort_data


def test_get_data():
    data = get_data()
    assert isinstance(data, list)


def test_get_filter_data(test_data):
    data = get_filter_data(test_data)
    assert [x['date'] for x in data] == ['2019-08-26T10:50:58.294041',
 '2019-07-03T18:35:29.512364',
 '2018-06-30T02:08:58.425572',
 '2018-03-23T10:45:06.972075',
 '2019-04-04T23:20:05.206878',
 '2019-03-23T01:09:46.296404',
 '2018-12-20T16:43:26.929246',
 '2019-07-12T20:41:47.882230',
 '2018-08-19T04:27:37.904916',
 '2018-07-11T02:26:18.671407',
 '2018-04-04T17:33:34.701093',
 '2019-12-08T22:46:21.935582',
 '2018-01-26T15:40:13.413061',
 '2018-11-29T07:18:23.941293',
 '2018-04-14T19:35:28.978265',
 '2019-09-11T17:30:34.445824',
 '2018-10-14T22:27:25.205631',
 '2019-04-12T17:27:27.896421',
 '2018-02-03T14:52:08.093722',
 '2018-03-02T02:03:11.563721',
 '2018-06-12T07:17:01.311610',
 '2018-12-28T23:10:35.459698',
 '2019-07-12T08:11:47.735774',
 '2018-02-22T00:40:19.984219',
 '2019-09-29T14:25:28.588059',
 '2018-01-21T01:10:28.317704',
 '2018-11-23T23:52:36.999661',
 '2019-06-01T06:46:16.803326',
 '2018-07-31T12:25:32.579413',
 '2019-04-11T23:10:21.514616',
 '2018-12-29T21:45:18.495053',
 '2019-06-14T19:37:49.044089',
 '2019-10-30T01:49:52.939296',
 '2019-11-05T12:04:13.781725',
 '2019-08-08T21:58:06.688541',
 '2019-11-19T09:22:25.899614',
 '2018-06-04T06:59:55.424356',
 '2018-10-15T08:05:34.061711',
 '2019-02-14T03:09:23.006652',
 '2018-03-09T02:11:01.339352',
 '2018-11-08T08:21:45.902633',
 '2019-08-15T01:48:10.042554',
 '2018-01-23T01:48:30.477053',
 '2018-01-13T13:00:58.458625',
 '2018-12-18T17:07:09.800800',
 '2019-07-08T00:08:32.986663',
 '2018-02-06T06:42:02.219233',
 '2019-06-21T12:34:06.351022',
 '2019-03-03T03:13:18.622393',
 '2018-08-25T02:58:18.764678',
 '2019-08-04T20:17:25.443322',
 '2019-09-07T07:20:13.889610',
 '2018-08-06T16:22:54.643491',
 '2019-05-07T01:32:37.142797',
 '2019-02-08T09:09:35.038506',
 '2019-06-16T22:17:01.825020',
 '2018-05-04T03:29:30.253483',
 '2019-03-29T10:57:20.635567',
 '2018-08-14T05:42:30.104666',
 '2018-05-05T01:38:56.538074',
 '2018-12-23T11:47:52.403285',
 '2019-12-07T06:17:14.634890',
 '2019-11-13T17:38:04.800051',
 '2019-06-30T15:11:53.136004',
 '2019-04-19T12:02:30.129240',
 '2018-04-16T17:34:19.241289',
 '2018-07-22T07:42:32.953324',
 '2018-02-03T07:16:28.366141',
 '2019-02-12T00:08:07.524972',
 '2018-04-22T17:01:46.885252',
 '2019-08-16T04:23:41.621065',
 '2018-07-06T22:32:10.495465',
 '2018-09-27T14:26:24.629306',
 '2019-05-06T00:17:42.736209',
 '2019-02-27T03:59:25.921176',
 '2019-07-18T12:27:13.355343',
 '2019-09-06T00:48:01.081967',
 '2018-06-20T03:59:34.851630',
 '2019-08-19T16:30:41.967497',
 '2018-12-22T02:02:49.564873',
 '2019-05-19T12:51:49.023880',
 '2018-03-09T23:57:37.537412',
 '2019-07-15T11:47:40.496961',
 '2019-01-05T00:52:30.108534',
 '2019-07-13T18:51:29.313309']


def test_get_format_data(test_data):
    data = get_format_data(test_data)
    assert data[0] == '26.08.2019 Перевод организации\n''Maestro 1596 37** **** 5199 -> Счет **********9589\n''31957.58 руб.'



def test_get_sort_data(test_data):
    data = get_sort_data(test_data)
    assert data == [{'date': '2019-12-08T22:46:21.935582',
  'description': 'Открытие вклада',
  'id': 863064926,
  'operationAmount': {'amount': '41096.24',
                      'currency': {'code': 'USD', 'name': 'USD'}},
  'state': 'EXECUTED',
  'to': 'Счет 90424923579946435907'},
 {'date': '2019-12-07T06:17:14.634890',
  'description': 'Перевод организации',
  'from': 'Visa Classic 2842878893689012',
  'id': 114832369,
  'operationAmount': {'amount': '48150.39',
                      'currency': {'code': 'USD', 'name': 'USD'}},
  'state': 'EXECUTED',
  'to': 'Счет 35158586384610753655'},
 {'date': '2019-12-03T04:27:03.427014',
  'description': 'Перевод с карты на карту',
  'from': 'MasterCard 1796816785869527',
  'id': 560813069,
  'operationAmount': {'amount': '17628.50',
                      'currency': {'code': 'USD', 'name': 'USD'}},
  'state': 'CANCELED',
  'to': 'Visa Classic 7699855375169288'},
 {'date': '2019-11-19T09:22:25.899614',
  'description': 'Перевод организации',
  'from': 'Maestro 7810846596785568',
  'id': 154927927,
  'operationAmount': {'amount': '30153.72',
                      'currency': {'code': 'RUB', 'name': 'руб.'}},
  'state': 'EXECUTED',
  'to': 'Счет 43241152692663622869'},
 {'date': '2019-11-13T17:38:04.800051',
  'description': 'Перевод со счета на счет',
  'from': 'Счет 38611439522855669794',
  'id': 482520625,
  'operationAmount': {'amount': '62814.53',
                      'currency': {'code': 'RUB', 'name': 'руб.'}},
  'state': 'EXECUTED',
  'to': 'Счет 46765464282437878125'}]

